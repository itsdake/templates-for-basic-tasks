{1,
{4,
{"Загрузка из Excel",1,0,"",""},
{0,
{"НачалоВыбораФайла_Excel",0,1,"Начал[оВыбораФайла]","&НаКлиенте
Процедура НачалоВыбораФайла(Элемент, ДанныеВыбора, ВыборДобавлением, СтандартнаяОбработка)  
	//Создание нового диалога выбора файла
	ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	//Начальное значение Пути к файлу - пустое
	ДиалогОткрытияФайла.ПолноеИмяФайла = """";
	// Установка параметров диалога выбора файла
	// Указываем фильтр для файлов только с расширением .csv
	ДиалогОткрытияФайла.Фильтр = ""Табличные документы (*.xlsx) | *.xlsx"";
	// Запрещаем множественный выбор файлов
	ДиалогОткрытияФайла.МножественныйВыбор = Ложь;
	// Заголовок окна выбора файла 
	ДиалогОткрытияФайла.Заголовок = ""Выберите файл"";
	// Записываем полный путь к выбранному файлу
	Если ДиалогОткрытияФайла.Выбрать() Тогда
		Объект.<?""Имя реквизита с полным именем файла""> = ДиалогОткрытияФайла.ПолноеИмяФайла;
	Иначе 
		// Если файл не выбран, выводим предупреждение 
		Сообщить(""Файл не выбран"");
	КонецЕсли;  
КонецПроцедуры
 "}
},
{0,
{"ЗагрузитьДанныеНаСервере_Excel_ТабДок",0,1,""," &НаСервере
Процедура ЗагрузитьДанныеНаСервере()
ТабДок = Новый ТабличныйДокумент; 
	
	Если Объект.<?""Имя реквизита с полным именем файла""> = """" тогда 
		
		Возврат;	
	КонецЕсли;
	ТабДок.Прочитать(Объект.<?""Имя реквизита с полным именем файла"">); 	
	Для НомерСтроки = <?""Начальный номер строки""> По ТабДок.ВысотаТаблицы Цикл 
		// Проверяем, существует ли в справочнике элемент с таким же Наименованием
		Если Справочники.<?""Имя справочника"">.НайтиПоНаименованию(ТабДок.Область(НомерСтроки,<?""Номер столбца Наименование"">).Текст) = Справочники.<?""Имя справочника"">.ПустаяСсылка()
			Тогда
			// создаем новый элемент справочника
			НовыйЭлемент 				   = Справочники.<?""Имя справочника"">.СоздатьЭлемент(); 
			//Заполняем реквизит Наименование нового элемента
			НовыйЭлемент.Наименование      = ТабДок.Область(НомерСтроки,<?""Номер столбца Наименование"">).Текст;
			
			//Заполняем остальные реквизиты нового элемента
			НовыйЭлемент.<?""Имя реквизита1""> = ТабДок.Область(НомерСтроки,<?""Номер столбца Реквизита1"">).Текст;
			НовыйЭлемент.<?""Имя реквизита2""> = ТабДок.Область(НомерСтроки,<?""Номер столбца Реквизита1"">).Текст;
			//.....
			//Далее аналогично добавить необходимое количество строк для добавления нужных реквизитов
			//.....
			//Записываем элемент в справочник 
			НовыйЭлемент.Записать();
			Сообщить(""Добавлен новый элемент "" +НовыйЭлемент.Наименование);    
		КонецЕсли;
		
	КонецЦикла;

КонецПроцедуры"}
},
{0,
{"ЗагрузитьНаКлиенте_Excel_ComОбъект",0,1,""," &НаКлиенте
 Процедура Загрузить(Команда)
	 
	 //Проверяем выбрал ли ФАЙЛ
	 Если Объект.<?""Имя реквизита с полным именем файла""> = """" Тогда
		 Сообщ=Новый СообщениеПользователю;
		 Сообщ.Текст=""Выберите файл!"";
		 Сообщ.Сообщить();
	 иначе
		 //создаем COM-объект для работы с excel
		 Эксель=новый COMОбъект(""Excel.Application"");
		 //открытие выбранного файла
		 КнигаЭксель=Эксель.Workbooks.Open(объект.<?""Имя реквизита с полным именем файла"">);
		 //Получение ссылки на первый лист
		 Лист1=КнигаЭксель.WorkSheets(1);
		 //начинаем цикл чтения со 2 строки
		 п=2;
		 Пока п<<?""Количество строк в файле""> цикл
			 //создание структуры хранения данных
			 СтруктураДанных =новый Структура;
			 //Получение данных из 1 колонки
			 СтруктураДанных.Вставить(""Наименование"",СокрЛП(Лист1.Cells(п,1).value));
			 //получение данных из 2 колонки
			 СтруктураДанных.Вставить(""<?""Имя реквизита2"">"",СокрЛП(Лист1.Cells(п,2).value));
			 //........
			 //Далее аналогично добавить необходимое количество вставки реквизитов 
			 //........
			 //Вызов процедуры на сервере
			 ЗагрузитьНаСервере(СтруктураДанных);
			 
			 п=п+1;
			 
		 КонецЦикла;    
		 //сообщение об успешной загрузке
		Сообщ=Новый СообщениеПользователю;
		Сообщ.Текст=""Данные успешно загружены"";
		Сообщ.Сообщить();  
		//Закрытие excel
		Эксель.Application.Quit();
		 
	 КонецЕсли
 КонецПроцедуры
"}
},
{0,
{"ЗагрузитьДанныеНаСервере_Excel_ComОбъект",0,1,"","//Процедура для сохранения данных на сервере
  &НаСервере
  Процедура ЗагрузитьНаСервере(СтруктураДанных)
	  
	  //Проверка, существует ли сотрудник в справочнике
	  Если Справочники.<?""Имя справочника"">.НайтиПоНаименованию(СтруктураДанных.Наименование)=Справочники.<?""Имя справочника"">.ПустаяСсылка() тогда
		  //Если сотрудника не существует, создаем нового
		   ДобавлениеЭлемента=Справочники.<?""Имя справочника"">.СоздатьЭлемент();
		   ДобавлениеЭлемента.Наименование=СтруктураДанных.Наименование;
		   //........
		   //Далее аналогично добавить необходимое количество вставки реквизитов в справочник 
		   //........
		   //Сохранение нового элемента в справочник
		   ДобавлениеЭлемента.Записать(); 
	   КонецЕсли;
	     
  КонецПроцедуры"}
}
}
}