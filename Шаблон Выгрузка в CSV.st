{1,
{2,
{"Выгрузка из CSV",1,0,"",""},
{0,
{"ВыгрузитьВ_CSV (Команда)",0,1,"","&НаКлиенте
Процедура ВыгрузитьВCSV(Команда)
	Док = ВыгрузитьНаСервере();
	
	ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);
	ДиалогОткрытияФайла.ПолноеИмяФайла = """";
	ДиалогОткрытияФайла.Фильтр = ""*.csv | *.csv"";
	ДиалогОткрытияФайла.МножественныйВыбор = Ложь;
	ДиалогОткрытияФайла.Заголовок = ""Выберите каталог для сохранения файла"";
	ДиалогОткрытияФайла.Выбрать();
	
	Док.Записать(ДиалогОткрытияФайла.ПолноеИмяФайла);
	
КонецПроцедуры
"}
},
{0,
{"ВыгрузитьВ_CSV_НаСервере",0,1,"","&НаСервере
Функция ВыгрузитьНаСервере()
    Запрос = Новый Запрос; // Создание нового объекта типа Запрос (для обращения к БД)
	Запрос.Текст = ""ВЫБРАТЬ
	               |	<?""Имя справочника"">.<?""Имя поля1""> КАК <?""Имя поля1"">,
	               |	<?""Имя справочника"">.<?""Имя поля2""> КАК <?""Имя поля2"">,
	               |	<?""Имя справочника"">.<?""Имя поля3""> КАК <?""Имя поля3"">
				   // Добавить необходимое количество строчек запроса для нужных полей
	               |ИЗ
	               |	Справочник.<?""Имя справочника""> КАК <?""Имя справочника"">""; 
	
	РезультатЗапроса = Запрос.Выполнить().Выбрать(); //Выполняем запрос к БД (к справочнику) и получаем результат
	Док = Новый ТекстовыйДокумент; // Создаем новый текстовый документ для записи данных из справочника
	Док.ДобавитьСтроку(""<?""Первая строка в файле - имена столбцов через разделитель"">"");  
	//Проходим по каждой записи из результата запроса
	Пока РезультатЗапроса.Следующий() Цикл    
		//формируем строку с данными и добавляем ее в текстовый документ
		Док.ДобавитьСтроку(РезультатЗапроса.<?""Имя поля1"">+""<?""Символ-разделитель""> ""+РезультатЗапроса.<?""Имя поля2"">+
		""<?""Символ-разделитель""> ""+РезультатЗапроса.<?""Имя поля3"">)//При необходимости добавить в строку нужное количество столбцов через симво-разделитель;
	КонецЦикла;
	
	Возврат Док; 

КонецФункции"}
}
}
}